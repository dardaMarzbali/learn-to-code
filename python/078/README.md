# No.078

問題: ログファイルのエラー監視

あなたはSREエンジニアとして、重要なウェブアプリケーションの監視を行っています。アプリケーションはログファイルにエラーメッセージを記録し、あなたはエラーが発生した場合に速やかに通知を受け取るためのスクリプトを作成することになりました。

以下の条件に従ってPythonスクリプトを作成してください：

1. アプリケーションのログファイルはテキストファイルで、行ごとにエラーメッセージが記録されています。ログファイルのパスはスクリプトに渡されます。
1. スクリプトはログファイルを定期的に監視し、新しいエラーメッセージが記録された場合に通知を行います。
1. スクリプトが新しいエラーメッセージを検出したら、指定された通知方法で通知を送信します。通知方法はコマンドライン引数として指定されます。例えば、メール、Slackメッセージ、またはカスタムAPIコールなどが考えられます。
1. スクリプトはエラーメッセージの重複通知を防ぐために、既知のエラーメッセージを記録しておきます。同じエラーメッセージが連続して発生しても、最初の一度だけ通知を行います。
1. スクリプトはエラーメッセージの解析に正規表現を使用し、特定のパターンに一致するエラーメッセージのみを通知します。

実行例:

```bash
$ python main.py logs/test.log
新しいエラーが検出されました: データベース接続エラーが発生しました。詳細: ホスト 'db.example.com' に接続できません。
新しいエラーが検出されました: データベースクエリの実行中にエラーが発生しました。詳細: クエリがタイムアウトしました。
新しいエラーが検出されました: アプリケーションがクラッシュしました。スタックトレース: ...
新しいエラーが検出されました: メモリ使用量が限界を超えました。アプリケーションを再起動してください。
新しいエラーが検出されました: CPU使用量が限界を超えました。アプリケーションを再起動してください。
```
