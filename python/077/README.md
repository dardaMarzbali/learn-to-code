# No.077

問題: ログファイルの自動アーカイブ

あなたはSREエンジニアとして、大規模なサーバーファームのログファイル管理を自動化するスクリプトを開発するプロジェクトに取り組んでいます。このスクリプトは、古いログファイルを自動的にアーカイブし、ディスクスペースを節約します。

以下の条件に従ってPythonスクリプトを作成してください：

1. コマンドライン引数としてアーカイブ対象ディレクトリのパス、アーカイブ先ディレクトリのパス、およびアーカイブを実行する日数（例：30日以上経過したログをアーカイブ）を指定するオプションを提供します。
1. 指定されたディレクトリ内のログファイルをスキャンし、指定された日数以上経過したログファイルを検出します。
1. 検出されたログファイルをアーカイブ先ディレクトリに移動します。アーカイブファイル名は元のファイル名にタイムスタンプを付けて変更します。
1. スクリプトが実行されるたびに、指定されたディレクトリ内のログファイルをスキャンし、アーカイブの対象となるファイルをアーカイブ先ディレクトリに移動します。
1. スクリプトはエラーが発生した場合に適切なエラーメッセージを表示し、問題を解決できるようにします。

指定された日数よりも古いログファイルをアーカイブするシンプルな自動アーカイブツールです。コマンドラインからログディレクトリ、アーカイブ先ディレクトリ、およびアーカイブ対象日数を指定して実行できます。アーカイブ対象のログファイルは、指定されたアーカイブ先ディレクトリに移動され、タイムスタンプがファイル名に付けられます。

実行例:

```bash
$ tree
.
├── README.md
├── logs
│   ├── file1.log
│   └── file2.log
└── main.py

2 directories, 4 files
$
$ ls -l logs/
total 16
-rw-r--r--@ 1 bfl  staff  5  1  1  2022 file1.log
-rw-r--r--@ 1 bfl  staff  5  9  4  2023 file2.log
$
$ python main.py logs archive 30
logs/file1.log をアーカイブしました。
アーカイブが完了しました。
$
$ tree
.
├── README.md
├── archive
│   └── file1_20220101235959.log
├── logs
│   └── file2.log
└── main.py

3 directories, 4 files
$
$ ls -l archive/
total 8
-rw-r--r--@ 1 bfl  staff  5  1  1  2022 file1_20220101235959.log
$
```
